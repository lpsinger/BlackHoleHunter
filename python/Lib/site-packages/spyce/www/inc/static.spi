[[\
  import spyce
  release = spyce.__release__
  egprefix = request.get1('egprefix')
]]

[[ def includeCode(filename, run=1): { 
  import os
  import pp
  import spyceUtil
]]
[[.compact mode=off]]
<table border=1 align=center>
<tr><td align=left bgcolor="#cccccc">
  <font face="arial, helvetica" size="-1"><b>[[=filename]]</b></font>
</td></tr><tr><td>
  <font face=courier>
[[\
  if filename.endswith('.py'):
    s = pp.prettyhtml(open(spyceUtil.url2file(filename, request.filename())))
  else:
    s = "<pre>%s</pre>" % include.spycecode(filename)
]]
    [[=s]]
  </font>
[[if run==1: {]]
  </td></tr><tr><td align=right bgcolor="#cccccc">
    <font face="arial, helvetica" size="-1">
      [[\
        href = '/'.join(os.path.split(filename))
        if egprefix:
          L = filename.split('examples/')
          if len(L) > 1:
            href = egprefix + L[1]
      ]]
      <b><a href="[[= href ]]">Run this code</a></b>
    </font>
[[ } ]]
</td></tr></table>
[[.compact]]
[[ } ]]
