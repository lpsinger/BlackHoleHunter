<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <style type="text/css"><!--
	.code {
	  border: 2px dotted;

	  font-family: Courier,monospace;
	  font-size: 90%;

	  background-color: #E0E0E0;
	  margin-left: 10;
	  margin-right: 10;
	  padding-left: 10;
	  padding-right: 10;
	  padding-top: 0;
	  padding-bottom: 10;
	}
    a { text-decoration: none; color: #0000cc }
    a:hover { text-decoration: underline; color: #0000cc; }
  --></style>
<title>Spyce - Python Server Pages (PSP)</title>
  <meta NAME="LANGUAGE" CONTENT="en-US">
  <meta NAME="RATING" CONTENT="GENERAL">
  <meta NAME="ROBOTS" CONTENT="ALL">
  <meta name="abstract" content="Spyce is a server-side language that supports simple and efficient Python-based dynamic HTML generation. Those who like Python and are familiar with JSP, or PHP, or ASP, should have a look at Spyce.">
  <meta name="description" content="Spyce - Python Server Pages: a server-side language that supports simple and efficient Python-based dynamic HTML generation.">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta HTTP-EQUIV="Refresh" CONTENT="1800">
  <meta HTTP-EQUIV="Revisit-After" CONTENT="15 days">
  <link rel="icon" href="spycefav.ico" type="image/x-icon">
  <link rel="shortcut icon" href="spycefav.ico" type="image/x-icon">
<link rel="Next" href="doc-None.html">
<link rel="next" href="doc-None.html">
<link rel="Previous" href="doc-None.html">
<link rel="Prev" href="doc-None.html">
<link rel="prev" href="doc-None.html">
<link rel="Contents" href="doc.html">
<link rel="contents" href="doc.html">
</head>

<body bgcolor="#efefef">

<table border=0 cellspacing=0 cellpadding=0 width="100%"><tr><td valign=top>

<!-- links section -->

<!-- index -->
<table border=0 align=center width="100%"><tr><td align=center nowrap>
  <a href="http://spyce.sourceforge.net"><img src="/spyce.gif" border=0 alt="spyce" width=58 height=70></a>
</td></tr></table>

<table align=center border=1 cellpadding=4 cellspacing=0 bgcolor="#CCCCCC">
<tr><td align=left bgColor="#AAAAAA"><b>
  <font face="arial, helvetica" size="-1">
<b><a href="/index.html">home</a></b><br>
  </font>
</b></td></tr>
<tr><td align=left>
  <font face="arial, helvetica" size="-1">
<b><a href="http://svn-hosting.com/svn/spyce/trunk/spyce/CHANGES">changelog</a></b><br>
<b><a href="/docs/license.html">license</a></b><br>
<b><a href="/docs/get.html">download</a></b><br>
<b><a href="/docs/mail.html">community</a></b><br>
<b><a href="/docs/wishlist.html">wishlist</a></b><br>
  </font>
</td></tr>
<tr><td align=left bgColor="#AAAAAA"><b>
  <font face="arial, helvetica" size="-1">
<b><a href="/docs/doc.html">documentation</a></b><br>
  </font>
</b></td></tr>
<tr><td align=left>
  <font face="arial, helvetica" size="-1">
<b><a href="/docs/doc-intro.html">intro</a></b><br>
<b><a href="/docs/doc-lang.html">language</a></b><br>
<b><a href="/docs/doc-runtime.html">runtime</a></b><br>
<b><a href="/docs/doc-mod.html">modules</a></b><br>
<b><a href="/docs/doc-tag.html">tags</a></b><br>
<b><a href="/docs/doc-conf.html">install</a></b><br>
<b><a href="/docs/eg.html">examples list</a></b><br>
  </font>
</td></tr>
<tr><td align=left bgColor="#AAAAAA"><b>
  <font face="arial, helvetica" size="-1">
      <b>other</b>
  </font>
</b></td></tr>
<tr><td align=left>
  <font face="arial, helvetica" size="-1">
<b><a href="/docs/links.html">resources</a></b><br>
<b><a href="http://sourceforge.net/projects/spyce/">sf project</a></b><br>
<b><a href="http://spyced.blogspot.com/">spyced blog</a></b><br>
  </font>
</td></tr></table><br>

<!-- spacers -->
</td>
<td width=15><img src=/trans1x1.gif width=15 height=1 ></td>
<td width=1 bgcolor="#888888"><img src=/trans1x1.gif width=1 height=1 ></td>
<td width=15><img src=/trans1x1.gif width=15 height=1 ></td>
<td width="100%" valign=top>

<!-- page title -->
<table border=0 width="100%"><tr>
  <td nowrap valign=bottom>
    <b><font face="arial, helvetica" size="-1"><big>Documentation</big></font></b><br clear=all>
  </td>
  <td align=right nowrap valign=bottom>
    <font face="arial, helvetica" size="-1">
    <b><big>[[ <font face="arial, helvetica" color="#cc0000">Spyce</font> ]]</big></b><br>
    </font>
</tr></table>

<hr>
<font face="arial, helvetica" size="-1">

<!-- body -->

<table width="100%" align=center><tr>
    <td align=left width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Prev:</b> None</font></td>
    <td align=center width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Up:</b> None</font></td>
    <td align=right width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Next:</b> None</font></td>
</tr></table>
<hr>
<big><a name="mod_include"></a><b>4.7. <font color=#ee0000>Include</font></b></big><p>


Many websites carry a theme across their various pages, which is often
achieved by including a common header or footer. This is best done with a
parent template from the <a href=doc-tag_form.html#parent>spy:parent tag</a>,
but you can also do this with the include module for backwards compatibility
with Spyce 1.x.
<p>
Another option to consider for repeating a common task is
a custom
<a href="doc-tag_new2.html">active tag</a>.
<p>
The include module can also pretty print Spyce code or include the contents of
anything in your filesystem.
<ul>
<li><b>spyce</b>( file, [context] ): <br> Dynamically includes the specified
<b>file</b> (corresponding to the Spyce document root, not filesystem),
and processes it as Spyce code. The return value is that of the
included Spyce file. One can optionally provide a <b>context</b> value to
the included file. If omitted, the value defaults to None. All currently
imported modules are passed along into the included file without
re-initialization. However, for each explicit <font
face=courier>[[.import&nbsp;]]</font> tag in the included file, a new
module is initialized and also finalized up at the end of processing. The
include module provides three fields for use inside included files: <p>
<ul>
<li>include.<b>context</b>: This field stores the value passed in at the
point of inclusion. Note that if the value is one that is passed by
reference (as is the case with object, list, and dictionary types), then
the context may be used to pass information back to the including file, in
addition to the return value. </li> <p>
<li>include.<b>vars</b>: If the include context is of type dictionary,
then the vars field is initialized, otherwise it is None. The vars field
provides attribute-based access to the context dictionary, merely for
convenience. In other words, <font face=courier>include.vars.x</font> is
equivalent to <font face=courier>include.context['x']</font>. </li> <p>
</ul>
Note that either the locals() or globals() dictionaries may be passed in as
include contexts. However, be advised that due to Python optimizations of
local variable access, any updates to the locals() dictionary may not be
reflected in the local namespace under all circumstances and all versions of
Python. In fact, this is the reason why the context has been made explicit,
and does not simply grab the locals() dictionary. It may, however, safely be
used for read access. With respect to the globals() dictionary, it is not
advised to <a href="doc-runtime_transform.html">pollute</a> this
namespace. </li><p>
<li><b>spyceStr</b>( file, [context] ): <br> Same as <b>spyce</b>(), but
performs no output and instead returns the processed included Spyce file as
a string.</li><p>
<li><b>dump</b>( file, [binary] ): <br> Contents of the <b>file</b>
(from the filesystem -- use spyceUtil.url2file(url, request.filename)
if you need to turn a url into a filesystem path)
are returned. If the <b>binary</b> parameter is true, the file is opened in
binary mode. By default, text mode is used.
<p><b>Be careful</b> not to blindly trust the user to specify which file
to dump, since anything your Spyce process has access to in the filesystem
is fair game.
</li><p>
<li><b>spycecode</b>( file ): <br> Contents of the <b>file</b>
(relative to the Spyce document root)
are returned
as HTML formatted Spyce code. </li><p>
</ul>
The example below (taken from this documentation file), uses a common header
template only requiring two context variables to change the title and the
highlighted link:<br>

<table align=center border=0><tr><td>
<font face=courier>
<b><pre>  [[.import name=include]]
  [[include.spyce('inc/head.spi', 
      {'pagename': 'Documentation', 
       'page': 'manual.html'}) ]]</pre></b>
</font>
</td></tr></table><p>

In <b>head.spi</b>, we use this information to set the title:<p>

<table align=center border=0><tr><td>
<font face=courier>
<b><pre>
  [[.import name=include]]
  &lt;title&gt;[[=include.context['pagename'] ]]&lt;/title&gt;
</pre></b>
</font>
</td></tr></table><p>

By convention, included files are given the extension <b>.spi</b>.<p>
Below we contrast the difference between static and dynamic includes. A
dynamic include is included on each request; a static include is inserted at
compile time. A static include runs in the same context, while a dynamic
include has a separate context.<p>

<table border=1 align=center>
<tr><td align=left bgcolor="#cccccc">
  <font face="arial, helvetica" size="-1"><b>examples/include.spy</b></font>
</td></tr><tr><td>
  <font face=courier>

    <pre><font color="#000000"><b><font color="#CC00CC">[[.import name=include]]</font>
&lt;html&gt;&lt;body&gt;
  main file&lt;br&gt;
  &lt;hr&gt;
  <font color="#0000CC">[[
    context = {'foo': 'old value'}
    result=include.spyce('include.spi', context)
  ]]</font>
  &lt;hr&gt;
  main file again&lt;br&gt;
  context: <font color="#CC0000">[[=context]]</font>&lt;br&gt;
  return value: <font color="#CC0000">[[=result]]</font>&lt;br&gt;
&lt;/body&gt;&lt;/html&gt;
</b></font></pre>
  </font>

  </td></tr><tr><td align=right bgcolor="#cccccc">
    <font face="arial, helvetica" size="-1">
      
      <b><a href="examples/include.spy">Run this code</a></b>
    </font>

</td></tr></table>
<p>

<table border=1 align=center>
<tr><td align=left bgcolor="#cccccc">
  <font face="arial, helvetica" size="-1"><b>examples/include.spi</b></font>
</td></tr><tr><td>
  <font face=courier>

    <pre><font color="#000000"><b>begin include&lt;br&gt;
context: <font color="#CC0000">[[=include.context ]]</font>&lt;br&gt;
from: <font color="#CC0000">[[=request.stack()[-2] ]]</font>&lt;br&gt;
foo was <font color="#CC0000">[[=include.vars.foo]]</font>&lt;br&gt;
setting foo to 'new value' <font color="#0000CC">[[include.vars.foo = 'new value']]</font>&lt;br&gt;
returing 'retval'&lt;br&gt;
end include&lt;br&gt;
<font color="#0000CC">[[ return 'retval' ]]</font>
</b></font></pre>
  </font>

</td></tr></table>
<p>

<table border=1 align=center>
<tr><td align=left bgcolor="#cccccc">
  <font face="arial, helvetica" size="-1"><b>examples/includestatic.spy</b></font>
</td></tr><tr><td>
  <font face=courier>

    <pre><font color="#000000"><b>&lt;html&gt;&lt;body&gt;
  <font color="#0000CC">[[x=1]]</font>
  main file&lt;br&gt;
  x=<font color="#CC0000">[[=x]]</font>&lt;br&gt;
  &lt;hr&gt;
  <font color="#CC00CC">[[.include file=&quot;includestatic.spi&quot;]]</font>
  &lt;hr&gt;
  main file again&lt;br&gt;
  x=<font color="#CC0000">[[=x]]</font>
&lt;/body&gt;&lt;/html&gt;
</b></font></pre>
  </font>

  </td></tr><tr><td align=right bgcolor="#cccccc">
    <font face="arial, helvetica" size="-1">
      
      <b><a href="examples/includestatic.spy">Run this code</a></b>
    </font>

</td></tr></table>
<p>

<table border=1 align=center>
<tr><td align=left bgcolor="#cccccc">
  <font face="arial, helvetica" size="-1"><b>examples/includestatic.spi</b></font>
</td></tr><tr><td>
  <font face=courier>

    <pre><font color="#000000"><b>begin included file&lt;br&gt;
changing value of x&lt;br&gt;
<font color="#0000CC">[[x=2]]</font>
end included file&lt;br&gt;
</b></font></pre>
  </font>

</td></tr></table>
<p>
<hr>

<table width="100%" align=center><tr>
    <td align=left width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Prev:</b> None</font></td>
    <td align=center width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Up:</b> None</font></td>
    <td align=right width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Next:</b> None</font></td>
</tr></table>
<!-- end body -->
<p>
</font>
</td></tr>
<tr><td colspan=5><hr></td></tr>
<tr><td colspan=5 height=15></td></tr>
<tr><td colspan=5>

  <table width="100%" border=0><tr>
    <td align=left valign=top>
      <font face="arial, helvetica" size="-1">
      <b><big>[[ <font face="arial, helvetica" color="#cc0000">Spyce</font> ]]</big></b><br>
      <small>Python Server Pages<br>version 2.0.3</small>
      </font>
    </td><td align=center valign=top>
      <a href="http://spyce.sourceforge.net"><img align=middle width=120 height=50 border=0 src="/spycepow.gif" alt="Spyce Powered"></a>
      <a href="http://sourceforge.net"><img align=middle src="http://sourceforge.net/sflogo.php?group_id=53655&amp;type=5" width="141" height="50" border="0" alt="SourceForge Logo"></a>
    </td><td align=right valign=top>
    </td>
  </tr></table>

</td></tr></table>

</body></html>
