<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <style type="text/css"><!--
	.code {
	  border: 2px dotted;

	  font-family: Courier,monospace;
	  font-size: 90%;

	  background-color: #E0E0E0;
	  margin-left: 10;
	  margin-right: 10;
	  padding-left: 10;
	  padding-right: 10;
	  padding-top: 0;
	  padding-bottom: 10;
	}
    a { text-decoration: none; color: #0000cc }
    a:hover { text-decoration: underline; color: #0000cc; }
  --></style>
<title>Spyce - Python Server Pages (PSP)</title>
  <meta NAME="LANGUAGE" CONTENT="en-US">
  <meta NAME="RATING" CONTENT="GENERAL">
  <meta NAME="ROBOTS" CONTENT="ALL">
  <meta name="abstract" content="Spyce is a server-side language that supports simple and efficient Python-based dynamic HTML generation. Those who like Python and are familiar with JSP, or PHP, or ASP, should have a look at Spyce.">
  <meta name="description" content="Spyce - Python Server Pages: a server-side language that supports simple and efficient Python-based dynamic HTML generation.">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta HTTP-EQUIV="Refresh" CONTENT="1800">
  <meta HTTP-EQUIV="Revisit-After" CONTENT="15 days">
  <link rel="icon" href="spycefav.ico" type="image/x-icon">
  <link rel="shortcut icon" href="spycefav.ico" type="image/x-icon">
<link rel="Next" href="doc-None.html">
<link rel="next" href="doc-None.html">
<link rel="Previous" href="doc-None.html">
<link rel="Prev" href="doc-None.html">
<link rel="prev" href="doc-None.html">
<link rel="Contents" href="doc.html">
<link rel="contents" href="doc.html">
</head>

<body bgcolor="#efefef">

<table border=0 cellspacing=0 cellpadding=0 width="100%"><tr><td valign=top>

<!-- links section -->

<!-- index -->
<table border=0 align=center width="100%"><tr><td align=center nowrap>
  <a href="http://spyce.sourceforge.net"><img src="/spyce.gif" border=0 alt="spyce" width=58 height=70></a>
</td></tr></table>

<table align=center border=1 cellpadding=4 cellspacing=0 bgcolor="#CCCCCC">
<tr><td align=left bgColor="#AAAAAA"><b>
  <font face="arial, helvetica" size="-1">
<b><a href="/index.html">home</a></b><br>
  </font>
</b></td></tr>
<tr><td align=left>
  <font face="arial, helvetica" size="-1">
<b><a href="http://svn-hosting.com/svn/spyce/trunk/spyce/CHANGES">changelog</a></b><br>
<b><a href="/docs/license.html">license</a></b><br>
<b><a href="/docs/get.html">download</a></b><br>
<b><a href="/docs/mail.html">community</a></b><br>
<b><a href="/docs/wishlist.html">wishlist</a></b><br>
  </font>
</td></tr>
<tr><td align=left bgColor="#AAAAAA"><b>
  <font face="arial, helvetica" size="-1">
<b><a href="/docs/doc.html">documentation</a></b><br>
  </font>
</b></td></tr>
<tr><td align=left>
  <font face="arial, helvetica" size="-1">
<b><a href="/docs/doc-intro.html">intro</a></b><br>
<b><a href="/docs/doc-lang.html">language</a></b><br>
<b><a href="/docs/doc-runtime.html">runtime</a></b><br>
<b><a href="/docs/doc-mod.html">modules</a></b><br>
<b><a href="/docs/doc-tag.html">tags</a></b><br>
<b><a href="/docs/doc-conf.html">install</a></b><br>
<b><a href="/docs/eg.html">examples list</a></b><br>
  </font>
</td></tr>
<tr><td align=left bgColor="#AAAAAA"><b>
  <font face="arial, helvetica" size="-1">
      <b>other</b>
  </font>
</b></td></tr>
<tr><td align=left>
  <font face="arial, helvetica" size="-1">
<b><a href="/docs/links.html">resources</a></b><br>
<b><a href="http://sourceforge.net/projects/spyce/">sf project</a></b><br>
<b><a href="http://spyced.blogspot.com/">spyced blog</a></b><br>
  </font>
</td></tr></table><br>

<!-- spacers -->
</td>
<td width=15><img src=/trans1x1.gif width=15 height=1 ></td>
<td width=1 bgcolor="#888888"><img src=/trans1x1.gif width=1 height=1 ></td>
<td width=15><img src=/trans1x1.gif width=15 height=1 ></td>
<td width="100%" valign=top>

<!-- page title -->
<table border=0 width="100%"><tr>
  <td nowrap valign=bottom>
    <b><font face="arial, helvetica" size="-1"><big>Documentation</big></font></b><br clear=all>
  </td>
  <td align=right nowrap valign=bottom>
    <font face="arial, helvetica" size="-1">
    <b><big>[[ <font face="arial, helvetica" color="#cc0000">Spyce</font> ]]</big></b><br>
    </font>
</tr></table>

<hr>
<font face="arial, helvetica" size="-1">

<!-- body -->

<table width="100%" align=center><tr>
    <td align=left width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Prev:</b> None</font></td>
    <td align=center width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Up:</b> None</font></td>
    <td align=right width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Next:</b> None</font></td>
</tr></table>
<hr>
<big><a name="mod_error"></a><b>4.3. <font color=#ee0000>Error</font></b></big><p>


The error module is implicitly loaded and provides error-handling
functionality. An error is any <a
href="doc-runtime_except.html">unhandled runtime exception</a> that
occurs <b>during Spyce processing</b>. This mechanism does not include
exceptions that are not related to Spyce processing (i.e. server-related
exceptions), that can be caused before or after Spyce processing by invalid
syntax, missing files and file access restrictions. To install a server-level
error handler use a <a href="doc-runtime_common.html">configuration
file</a>. The default page-level error handler can also be modified in the <a
href="doc-runtime_common.html">configuration file</a>. This module
allows the user to install page-level error handling code, overriding the
default page-level handler, by using one of the following functions: <p>
<ul>
<li><b>setStringHandler</b>( string ): <br> Installs a function that will
processes the given <b>string</b>, as Spyce code, for error handling.
</li><p>
<li><b>setFileHandler</b>( uri ): <br> Installs a function that will
processes the given <b>uri</b> for error handling. </li><p>
<li><b>setHandler</b>( fn ): <br> Installs the <b>fn</b> function for error
handling. The function is passed one parameter, a reference to the error
module. From this, all the error information as well as references to other
modules and Spyce objects can be accessed.</li><p>
</ul>
The error module provides the following information about an error: <p>
<ul>
<li><b>isError</b>(): <br> Returns whether an error is being handled.
</li><p>
<li><b>getMessage</b>(): <br> Return the error message; the string of the
object that was raised, or None if there is no current error. </li><p>
<li><b>getType</b>(): <br> Return the error type; the type of the object
that was raised, or None if there is no current error. </li><p>
<li><b>getFile</b>(): <br> Return the file where the error was raised, or
None if there is no current error. </li><p>
<li><b>getTraceback</b>(): <br> Return the stack trace as an array of
tuples, or None if there is no current error. Each tuple entry is of the
form: (file, line numbers, function name, code context).</li><p>
<li><b>getString</b>(): <br> Return the string of the entire error (the
string representation of the message, type, location and stack trace), or
None if there is no current error. </li><p>
</ul>
The default error handling function uses the following string handler:
<table border=0 align=center><tr><td>
<pre><font color="#000000"><b>
<font color="#CC00CC">[[.module name=transform]]</font>
<font color="#0000CC">[[transform.expr('html_encode')]]</font>
&lt;html&gt;
&lt;title&gt;Spyce exception: <font color="#CC0000">[[=error.getMessage()]]</font>&lt;/title&gt;
&lt;body&gt;
&lt;table cellspacing=10 border=0&gt;
  &lt;tr&gt;&lt;td colspan=2&gt;&lt;h1&gt;Spyce exception&lt;/h1&gt;&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td valign=top align=right&gt;&lt;b&gt;File:&lt;/b&gt;&lt;/td&gt;&lt;td&gt;<font color="#CC0000">[[=error.getFile()]]</font>&lt;/tr&gt;
  &lt;tr&gt;&lt;td valign=top align=right&gt;&lt;b&gt;Message:&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;pre&gt;<font color="#CC0000">[[=error.getMessage()]]</font>&lt;/pre&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td valign=top align=right&gt;&lt;b&gt;Stack:&lt;/b&gt;&lt;/td&gt;&lt;td&gt;
    <font color="#0000CC">[[\
      L = list(error.getTraceback())
      L.reverse()
    ]]</font>
    <font color="#0000CC">[[ for frame in L: { ]]</font>
      <font color="#CC0000">[[=frame[0] ]]</font>:<font color="#CC0000">[[=frame[1] ]]</font>, in <font color="#CC0000">[[=frame[2] ]]</font>:&lt;br&gt;
      &lt;table border=0&gt;&lt;tr&gt;&lt;td width=10&gt;&lt;/td&gt;&lt;td&gt;
        &lt;pre&gt;<font color="#CC0000">[[=frame[3] ]]</font>&lt;/pre&gt;
      &lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
    <font color="#0000CC">[[ } ]]</font>
    &lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/body&gt;&lt;/html&gt;
</b></font></pre>
</td></tr></table>
<p>
The example below shows the error module in use. Error handling can often be
used to send emails notifying webmasters of problems, as this example shows.
<p>

<table border=1 align=center>
<tr><td align=left bgcolor="#cccccc">
  <font face="arial, helvetica" size="-1"><b>examples/error.spy</b></font>
</td></tr><tr><td>
  <font face=courier>

    <pre><font color="#000000"><b><font color="#0000CC">[[error.setFileHandler('error.spi') ]]</font>
This is a page with an error...
<font color="#0000CC">[[ raise 'an error' ]]</font>
</b></font></pre>
  </font>

  </td></tr><tr><td align=right bgcolor="#cccccc">
    <font face="arial, helvetica" size="-1">
      
      <b><a href="examples/error.spy">Run this code</a></b>
    </font>

</td></tr></table>
<p>

<table border=1 align=center>
<tr><td align=left bgcolor="#cccccc">
  <font face="arial, helvetica" size="-1"><b>examples/error.spi</b></font>
</td></tr><tr><td>
  <font face=courier>

    <pre><font color="#000000"><b>&lt;h1&gt;Oops&lt;/h1&gt;
An error occurred while processing your request. 
We have logged this for our webmasters, and they 
will fix it shortly. We apologize for the inconvenience.
In the meantime, please use the parts of our site that 
actually do work... &lt;a href=&quot;somewhere&quot;&gt;somewhere&lt;/a&gt;.
<font color="#0000CC">[[\
  # could redirect the user immediately
  #response.getModule('redirect').external('somewhere.spy')

  # could send an email
  import time
  msg = '''
time: %s
error: %s
env: %s
other info...
''' % (
    time.asctime(time.localtime(time.time())), 
    error.getString(),
    request.env()
  )
  #function_to_send_email('webmaster@foo.com', msg)

  #or perform other generic error handling...
]]</font>
</b></font></pre>
  </font>

</td></tr></table>
<p>
This mechanism is not a subsititute for proper exception handling within the
code itself, and should not be abused. It does, however, serve as a useful
catch-all for bugs that slip through the cracks. <p>
<hr>

<table width="100%" align=center><tr>
    <td align=left width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Prev:</b> None</font></td>
    <td align=center width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Up:</b> None</font></td>
    <td align=right width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Next:</b> None</font></td>
</tr></table>
<!-- end body -->
<p>
</font>
</td></tr>
<tr><td colspan=5><hr></td></tr>
<tr><td colspan=5 height=15></td></tr>
<tr><td colspan=5>

  <table width="100%" border=0><tr>
    <td align=left valign=top>
      <font face="arial, helvetica" size="-1">
      <b><big>[[ <font face="arial, helvetica" color="#cc0000">Spyce</font> ]]</big></b><br>
      <small>Python Server Pages<br>version 2.0.3</small>
      </font>
    </td><td align=center valign=top>
      <a href="http://spyce.sourceforge.net"><img align=middle width=120 height=50 border=0 src="/spycepow.gif" alt="Spyce Powered"></a>
      <a href="http://sourceforge.net"><img align=middle src="http://sourceforge.net/sflogo.php?group_id=53655&amp;type=5" width="141" height="50" border="0" alt="SourceForge Logo"></a>
    </td><td align=right valign=top>
    </td>
  </tr></table>

</td></tr></table>

</body></html>
