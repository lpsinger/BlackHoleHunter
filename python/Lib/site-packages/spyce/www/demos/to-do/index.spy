[[ import urllib ]]
[[.import name=tododata as=data ]]

[[-- Apply the parent template for title, header/footer.
     Note that we're specifying a src attribute here, so Spyce picks up parent.spi from
     the current (/demos/to-do/) directory.  If no src is given, Spyce uses the site 
     template, which by default is located in /parent.spi.  --]]
<spy:parent src=parent.spi title="To-do demo" />

[[-- the spyce form library lets us specify python functions as handlers for submit tags --]]
<f:form>

<h2>To-do lists</h2>
<ul>
  [[ for todo in data.listroot().values():{ ]]
  <li><a href=list-view.spy?todoid=[[= todo.id() ]]>[[= todo.description ]]</a>
  <f:checkbox name=todoid value="=todo.id()" />
  [[ } ]]
  
  [[ if 'todo' not in locals():{ ]]
  <li>(No lists created)
  [[ } ]]
</ul>

<h2>Actions</h2>
<ul>
  [[ if 'todo' in locals():{ ]]
  <li>
    [[-- model will be automatically imported by the form handler --]]
    <f:submit value="Delete checked" handler=model.list_delete confirm="Are you sure you want to delete these lists?" />
  [[ } ]]
  <li>
    <f:submit value="New list" handler=model.list_new />:
    <f:text name=description value="" />
</ul>

</f:form>
