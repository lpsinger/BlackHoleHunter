<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <style type="text/css"><!--
	.code {
	  border: 2px dotted;

	  font-family: Courier,monospace;
	  font-size: 90%;

	  background-color: #E0E0E0;
	  margin-left: 10;
	  margin-right: 10;
	  padding-left: 10;
	  padding-right: 10;
	  padding-top: 0;
	  padding-bottom: 10;
	}
    a { text-decoration: none; color: #0000cc }
    a:hover { text-decoration: underline; color: #0000cc; }
  --></style>
<title>Spyce - Python Server Pages (PSP)</title>
  <meta NAME="LANGUAGE" CONTENT="en-US">
  <meta NAME="RATING" CONTENT="GENERAL">
  <meta NAME="ROBOTS" CONTENT="ALL">
  <meta name="abstract" content="Spyce is a server-side language that supports simple and efficient Python-based dynamic HTML generation. Those who like Python and are familiar with JSP, or PHP, or ASP, should have a look at Spyce.">
  <meta name="description" content="Spyce - Python Server Pages: a server-side language that supports simple and efficient Python-based dynamic HTML generation.">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta HTTP-EQUIV="Refresh" CONTENT="1800">
  <meta HTTP-EQUIV="Revisit-After" CONTENT="15 days">
  <link rel="icon" href="spycefav.ico" type="image/x-icon">
  <link rel="shortcut icon" href="spycefav.ico" type="image/x-icon">
<link rel="Next" href="doc-None.html">
<link rel="next" href="doc-None.html">
<link rel="Previous" href="doc-None.html">
<link rel="Prev" href="doc-None.html">
<link rel="prev" href="doc-None.html">
<link rel="Contents" href="doc.html">
<link rel="contents" href="doc.html">
</head>

<body bgcolor="#efefef">

<table border=0 cellspacing=0 cellpadding=0 width="100%"><tr><td valign=top>

<!-- links section -->

<!-- index -->
<table border=0 align=center width="100%"><tr><td align=center nowrap>
  <a href="http://spyce.sourceforge.net"><img src="/spyce.gif" border=0 alt="spyce" width=58 height=70></a>
</td></tr></table>

<table align=center border=1 cellpadding=4 cellspacing=0 bgcolor="#CCCCCC">
<tr><td align=left bgColor="#AAAAAA"><b>
  <font face="arial, helvetica" size="-1">
<b><a href="/index.html">home</a></b><br>
  </font>
</b></td></tr>
<tr><td align=left>
  <font face="arial, helvetica" size="-1">
<b><a href="http://svn-hosting.com/svn/spyce/trunk/spyce/CHANGES">changelog</a></b><br>
<b><a href="/docs/license.html">license</a></b><br>
<b><a href="/docs/get.html">download</a></b><br>
<b><a href="/docs/mail.html">community</a></b><br>
<b><a href="/docs/wishlist.html">wishlist</a></b><br>
  </font>
</td></tr>
<tr><td align=left bgColor="#AAAAAA"><b>
  <font face="arial, helvetica" size="-1">
<b><a href="/docs/doc.html">documentation</a></b><br>
  </font>
</b></td></tr>
<tr><td align=left>
  <font face="arial, helvetica" size="-1">
<b><a href="/docs/doc-intro.html">intro</a></b><br>
<b><a href="/docs/doc-lang.html">language</a></b><br>
<b><a href="/docs/doc-runtime.html">runtime</a></b><br>
<b><a href="/docs/doc-mod.html">modules</a></b><br>
<b><a href="/docs/doc-tag.html">tags</a></b><br>
<b><a href="/docs/doc-conf.html">install</a></b><br>
<b><a href="/docs/eg.html">examples list</a></b><br>
  </font>
</td></tr>
<tr><td align=left bgColor="#AAAAAA"><b>
  <font face="arial, helvetica" size="-1">
      <b>other</b>
  </font>
</b></td></tr>
<tr><td align=left>
  <font face="arial, helvetica" size="-1">
<b><a href="/docs/links.html">resources</a></b><br>
<b><a href="http://sourceforge.net/projects/spyce/">sf project</a></b><br>
<b><a href="http://spyced.blogspot.com/">spyced blog</a></b><br>
  </font>
</td></tr></table><br>

<!-- spacers -->
</td>
<td width=15><img src=/trans1x1.gif width=15 height=1 ></td>
<td width=1 bgcolor="#888888"><img src=/trans1x1.gif width=1 height=1 ></td>
<td width=15><img src=/trans1x1.gif width=15 height=1 ></td>
<td width="100%" valign=top>

<!-- page title -->
<table border=0 width="100%"><tr>
  <td nowrap valign=bottom>
    <b><font face="arial, helvetica" size="-1"><big>Documentation</big></font></b><br clear=all>
  </td>
  <td align=right nowrap valign=bottom>
    <font face="arial, helvetica" size="-1">
    <b><big>[[ <font face="arial, helvetica" color="#cc0000">Spyce</font> ]]</big></b><br>
    </font>
</tr></table>

<hr>
<font face="arial, helvetica" size="-1">

<!-- body -->

<table width="100%" align=center><tr>
    <td align=left width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Prev:</b> None</font></td>
    <td align=center width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Up:</b> None</font></td>
    <td align=right width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Next:</b> None</font></td>
</tr></table>
<hr>
<big><a name="mod_lambda"></a><b>4.5. <font color=#ee0000>Spylambda</font></b></big><p>


The spylambda module is loaded implicitly and allows the definition of
functions based on Spyce scripts. The spylambda module provides the following
methods:
<ul>
<li><b>define</b>( args, code, [memoize] ): <br> Returns a function that
accepts the given <b>args</b> and executes the Spyce script defined by the
<b>code</b> parameter. Note that the code is compiled immediately and that
<font face=courier>spyce.spyceSyntaxError</font> or <font
face=courier>spyce.spycePythonError</font> exceptions can be thrown for
invalid code arguments. The optional <b>memoize</b> parameter sets whether
the spyce can or can not be memoized, with the default being false.
Memoizing a function means capturing the result and output and caching them,
keyed on the function parameters. Later, if a function is called again with
the same parameters, the cached information is returned, if it exists, and
the function may not actually be called. Thus, you should only memoize
functions that are truly functional, i.e. they do not have side-effects:
they only return a value and output data to the response object, and their
behaviour depends exclusively on their parameters. If you memoize code that
does have side-effects, those side-effects may not occur on every
invocation. </li> <p>
<li><b>__call__</b>( args, code, _spyceCache ): <br> This is an alias to the
define function. Because of the special method name, the spylambda module
object can be <a
href="http://www.python.org/doc/current/ref/callable-types.html">called as
if it were a function</a>. </li> <p>
</ul>
This function is not frequently called directly from Spyce code, because
writing the Spyce code argument in a manner that does not conflict with the
Spyce tag delimiters is cumbersome. Rather the <a
href="doc-lang_lambda.html">Spyce lambda</a> syntax is used and
translated into this function call at compilation time, as in the example
below. <p>

<table border=1 align=center>
<tr><td align=left bgcolor="#cccccc">
  <font face="arial, helvetica" size="-1"><b>examples/spylambda.spy</b></font>
</td></tr><tr><td>
  <font face=courier>

    <pre><font color="#000000"><b><font color="#0000CC">[[\
  # table template
  table = <font color="#000000"><b>[[spy! title, data: 
    &lt;table&gt;
      &lt;tr&gt;
        <font color="#0000CC">[[for cell in title: {]]</font>
          &lt;td&gt;&lt;b&gt;<font color="#CC0000">[[=cell]]</font>&lt;/b&gt;&lt;/td&gt;
        <font color="#0000CC">[[}]]</font>
      &lt;/tr&gt;
      <font color="#0000CC">[[for row in data: {]]</font>
        &lt;tr&gt;
          <font color="#0000CC">[[for cell in row: {]]</font>
            &lt;td&gt;<font color="#CC0000">[[=cell]]</font>&lt;/td&gt;
          <font color="#0000CC">[[}]]</font>
        &lt;/tr&gt;
      <font color="#0000CC">[[}]]</font>
    &lt;/table&gt; 
  ]]</b></font>

  # table information
  title = ['Country', 'Size', 'Population', 'GDP per capita']
  data = [
    [ 'USA', '9,158,960', '280,562,489', '$36,300' ],
    [ 'Canada', '9,220,970', '31,902,268', '$27,700' ],
    [ 'Mexico', '1,923,040', '103,400,165', '$9,000' ],
  ]
]]</font>

<font color="#ff7448">[[-- emit web page --]]</font>
&lt;html&gt;&lt;body&gt;
  <font color="#0000CC">[[ table(title, data) ]]</font>
&lt;/body&gt;&lt;/html&gt;

</b></font></pre>
  </font>

  </td></tr><tr><td align=right bgcolor="#cccccc">
    <font face="arial, helvetica" size="-1">
      
      <b><a href="examples/spylambda.spy">Run this code</a></b>
    </font>

</td></tr></table>
 <p>
It often useful to use the spylambda module directly from other Spyce modules
that may need to perform significant amounts of output. Rather than calling
<font face="courier">print</font> repeatedly, it is more convenient to invoke
a Spyce, as in the example below. Though highly simplified, this example also
shows how Spyce lambdas can be used to easily build a complex rendering
environment. <p>

<table border=1 align=center>
<tr><td align=left bgcolor="#cccccc">
  <font face="arial, helvetica" size="-1"><b>examples/myPortal.spy</b></font>
</td></tr><tr><td>
  <font face=courier>

    <pre><font color="#000000"><b><font color="#CC00CC">[[.import name=myPortal]]</font>
<font color="#0000CC">[[
# this data might be pulled from a database
news = {
  'heading': 'News',
  'data': [
    ('&lt;a href=&quot;http://www.nytimes.com&quot;&gt;nyt&lt;/a&gt;', 
      'today', 'sun rose'),
    ('&lt;a href=&quot;http://www.cnn.com&quot;&gt;cnn&lt;/a&gt;', 
      'yesterday', 'sun set'),
    ('&lt;a href=&quot;http://news.google.com&quot;&gt;goo&lt;/a&gt;', 
      'long time ago', 'let there be light!'), ] }
weather = {
  'heading': 'Weather',
  'data': [
    ('nyc', 'too cold'),
    ('seattle', 'too wet'),
    ('tucson', 'too dry'),
    ('houston', 'too humid'),
    ('chicago', 'too windy'),
    ('&lt;a href=&quot;http://www.carrier.com/&quot;&gt;carrier&lt;/a&gt;', 
      'just right'), ] }
movies = {
  'heading': 'Movies',
  'data': [
    ('over-priced theatre', '15 movies'),
    (&quot;'el cheapo&quot;, '3 movies'),
    ('home', 'blockbuster'), ] }
selection = [ news, movies, weather ]
]]</font>

&lt;html&gt;&lt;body&gt;
    Dear user <font color="#CC0000">[[='XYZ']]</font>, &lt;br&gt;
    Welcome to your portal. Here are your selected views... &lt;br&gt;
    <font color="#ff7448">[[-- a module that does a lot of output --]]</font>
    <font color="#0000CC">[[ myPortal.show( selection ) ]]</font>
&lt;/body&gt;&lt;/html&gt;
</b></font></pre>
  </font>

  </td></tr><tr><td align=right bgcolor="#cccccc">
    <font face="arial, helvetica" size="-1">
      
      <b><a href="examples/myPortal.spy">Run this code</a></b>
    </font>

</td></tr></table>
 <p>

<table border=1 align=center>
<tr><td align=left bgcolor="#cccccc">
  <font face="arial, helvetica" size="-1"><b>examples/myPortal.py</b></font>
</td></tr><tr><td>
  <font face=courier>

    
<style>    
.STRING {
  color: #a0522d;
}
.COMMENT {
  color: #ff7448;
  font-family: serif;
}
.KEYWORD {
  color: #9e79af;
}
.FUNCTION {
  color: #0074ef;
}
</style>
<pre>
<span class="KEYWORD">from</span> <span class="NAME">spyceModule</span> <span class="KEYWORD">import</span> <span class="NAME">spyceModule</span><span class="NEWLINE">
</span><span class="NL">
</span><span class="NAME">__doc__</span> <span class="OP">=</span> <span class="STRING">'''This module takes care of presenting the portal.
Spyce lambdas are easier to use to perform the output.'''</span><span class="NEWLINE">
</span><span class="NL">
</span><span class="KEYWORD">class</span> <span class="FUNCTION">myPortal</span><span class="OP">(</span><span class="NAME">spyceModule</span><span class="OP">)</span><span class="OP">:</span><span class="NEWLINE">
</span><span class="INDENT">  </span><span class="KEYWORD">def</span> <span class="FUNCTION">start</span><span class="OP">(</span><span class="NAME">self</span><span class="OP">)</span><span class="OP">:</span><span class="NEWLINE">
</span><span class="INDENT">    </span><span class="NAME">self</span><span class="OP">.</span><span class="NAME">show</span> <span class="OP">=</span> <span class="NAME">self</span><span class="OP">.</span><span class="NAME">_api</span><span class="OP">.</span><span class="NAME">getModule</span><span class="OP">(</span><span class="STRING">'spylambda'</span><span class="OP">)</span><span class="OP">(</span><span class="NAME">spysigPortal</span><span class="OP">,</span> <span class="NAME">spycodePortal</span><span class="OP">)</span><span class="NEWLINE">
</span>    <span class="NAME">self</span><span class="OP">.</span><span class="NAME">showView</span> <span class="OP">=</span> <span class="NAME">self</span><span class="OP">.</span><span class="NAME">_api</span><span class="OP">.</span><span class="NAME">getModule</span><span class="OP">(</span><span class="STRING">'spylambda'</span><span class="OP">)</span><span class="OP">(</span><span class="NAME">spysigItem</span><span class="OP">,</span> <span class="NAME">spycodeItem</span><span class="OP">)</span><span class="NEWLINE">
</span><span class="NL">
</span><span class="DEDENT"></span><span class="DEDENT"></span><span class="NAME">spysigPortal</span> <span class="OP">=</span> <span class="STRING">'selection'</span><span class="NEWLINE">
</span><span class="NAME">spycodePortal</span> <span class="OP">=</span> <span class="STRING">'''
  &lt;html&gt;&lt;body&gt;
    &lt;table align=center valign=center border=1 width=100% bgcolor="#aaaaaa"&gt;&lt;tr&gt;
      &lt;td width=30% &gt;
        [[ for view in selection: {]]
          [[myPortal.showView(view['heading'], view['data'])]]
          &lt;p&gt;
        [[ } ]]
      &lt;/td&gt;
      &lt;td align=center valign=center width=50% &gt;&lt;b&gt;main panel&lt;/b&gt;&lt;/td&gt;
      &lt;td align=center valign=center width=20% &gt;&lt;b&gt;other stuff&lt;/b&gt;&lt;/td&gt;
    &lt;/tr&gt;&lt;table&gt;
  &lt;/body&gt;&lt;/html&gt;
'''</span><span class="NEWLINE">
</span><span class="NL">
</span><span class="NAME">spysigItem</span> <span class="OP">=</span> <span class="STRING">'heading, data'</span><span class="NEWLINE">
</span><span class="NAME">spycodeItem</span> <span class="OP">=</span> <span class="STRING">'''
  &lt;table cellspacing=0 border=0 bgcolor="#ffdddd" width=100% &gt;
    &lt;tr&gt;&lt;td bgcolor="#bbddff" colspan=[[=max(map(len, data))]]&gt;
      &lt;b&gt;[[=heading]]&lt;b&gt;
    &lt;/td&gt;&lt;/tr&gt;
    [[ for row in data: { ]]
      &lt;tr&gt; 
        [[ for i in row: { ]]
          &lt;td&gt;[[=i]]&lt;/td&gt; 
        [[ } ]]
      &lt;/tr&gt;
    [[ } ]]
  &lt;/table&gt;
'''</span><span class="NEWLINE">
</span><span class="ENDMARKER"></span>
</pre>
    
  </font>

</td></tr></table>
 <p>
<hr>

<table width="100%" align=center><tr>
    <td align=left width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Prev:</b> None</font></td>
    <td align=center width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Up:</b> None</font></td>
    <td align=right width="33%" nowrap><font face="arial, helvetica" size="-1"><b>Next:</b> None</font></td>
</tr></table>
<!-- end body -->
<p>
</font>
</td></tr>
<tr><td colspan=5><hr></td></tr>
<tr><td colspan=5 height=15></td></tr>
<tr><td colspan=5>

  <table width="100%" border=0><tr>
    <td align=left valign=top>
      <font face="arial, helvetica" size="-1">
      <b><big>[[ <font face="arial, helvetica" color="#cc0000">Spyce</font> ]]</big></b><br>
      <small>Python Server Pages<br>version 2.0.3</small>
      </font>
    </td><td align=center valign=top>
      <a href="http://spyce.sourceforge.net"><img align=middle width=120 height=50 border=0 src="/spycepow.gif" alt="Spyce Powered"></a>
      <a href="http://sourceforge.net"><img align=middle src="http://sourceforge.net/sflogo.php?group_id=53655&amp;type=5" width="141" height="50" border="0" alt="SourceForge Logo"></a>
    </td><td align=right valign=top>
    </td>
  </tr></table>

</td></tr></table>

</body></html>
